import{c as be,a as r,d as Oe,e as gt,f as c,s as g,t as _e}from"../chunks/B35PcQGF.js";import{o as bt}from"../chunks/lRhbJWai.js";import{f as J,p as nt,d as dt,aj as xt,k as a,i as s,r as t,t as k,j as e,s as $e,g as S,e as yt,$ as $t,u as l,n as B,ak as wt}from"../chunks/BZjX7xHU.js";import{l as qe,s as Ke,p as ge,i as O,a as kt,b as Ye}from"../chunks/D9uJM2wH.js";import{I as De,s as We,b as Ze,f as je,o as Pt,h as zt,e as Te,i as Fe,q as et,t as tt}from"../chunks/DQl7avGA.js";import{I as Jt,b as St}from"../chunks/x5lqHpA1.js";import{j as M}from"../chunks/DPAJ9e7j.js";import{p as At}from"../chunks/BAylat5N.js";import{f as at,b as rt,p as Me}from"../chunks/BWqZDye-.js";import{P as Ct,R as Tt}from"../chunks/CP3XHTay.js";import{X as Ft,C as st,A as ot}from"../chunks/kp9I4jKG.js";import{B as le}from"../chunks/D5w3vmtt.js";import{B as Be}from"../chunks/DAS_cPG8.js";import{S as Mt}from"../chunks/BMMDD9hE.js";import{C as Rt}from"../chunks/D1NRD0ur.js";import"../chunks/_G6KF_sA.js";import{S as jt}from"../chunks/CcT_CqqL.js";import{A as lt}from"../chunks/B2p6WnG4.js";import{T as it}from"../chunks/BP1l7xaz.js";import{C as Nt}from"../chunks/x500Jt59.js";function Et(q,o){const F=qe(o,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=[["path",{d:"m15 18-6-6 6-6"}]];De(q,Ke({name:"chevron-left"},()=>F,{get iconNode(){return u},children:(j,N)=>{var A=be(),_=J(A);We(_,o,"default",{}),r(j,A)},$$slots:{default:!0}}))}function It(q,o){const F=qe(o,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];De(q,Ke({name:"copy"},()=>F,{get iconNode(){return u},children:(j,N)=>{var A=be(),_=J(A);We(_,o,"default",{}),r(j,A)},$$slots:{default:!0}}))}function Ht(q,o){const F=qe(o,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=[["polygon",{points:"6 3 20 12 6 21 6 3"}]];De(q,Ke({name:"play"},()=>F,{get iconNode(){return u},children:(j,N)=>{var A=be(),_=J(A);We(_,o,"default",{}),r(j,A)},$$slots:{default:!0}}))}var Lt=c('<div class="flex items-center justify-between px-6 py-4 border-b border-white/10"><h2 class="text-lg font-semibold"> </h2> <button type="button" class="p-2 rounded-lg hover:bg-white/10 transition-colors"><!></button></div>'),Bt=c('<div class="flex justify-end gap-3 px-6 py-4 border-t border-white/10"><!></div>'),Ot=c(`<div class="
			fixed inset-0 z-50
			flex items-center justify-center p-4
			bg-dark-900/85 backdrop-blur-sm
			animate-fade-in
		" role="dialog" aria-modal="true"><div><!> <div class="p-6"><!></div> <!></div></div>`);function qt(q,o){nt(o,!0);let F=ge(o,"open",15,!1),u=ge(o,"title",3,""),j=ge(o,"class",3,"");function N(E){var b;E.target===E.currentTarget&&(F(!1),(b=o.onclose)==null||b.call(o))}function A(E){var b;E.key==="Escape"&&(F(!1),(b=o.onclose)==null||b.call(o))}var _=be();gt("keydown",xt,A);var X=J(_);{var D=E=>{var b=Ot();b.__click=N;var Q=a(b),ae=a(Q);{var ie=W=>{var Y=Lt(),ne=a(Y),de=a(ne,!0);t(ne);var Z=s(ne,2);Z.__click=()=>{var ee;F(!1),(ee=o.onclose)==null||ee.call(o)};var pe=a(Z);Ft(pe,{size:20}),t(Z),t(Y),k(()=>g(de,u())),r(W,Y)};O(ae,W=>{u()&&W(ie)})}var f=s(ae,2),n=a(f);Ze(n,()=>o.children),t(f);var we=s(f,2);{var Ne=W=>{var Y=Bt(),ne=a(Y);Ze(ne,()=>o.footer),t(Y),r(W,Y)};O(we,W=>{o.footer&&W(Ne)})}t(Q),t(b),k(()=>je(Q,1,`
				w-full max-w-2xl
				bg-dark-800 border border-white/10 rounded-2xl
				shadow-2xl animate-slide-up
				${j()??""}
			`)),r(E,b)};O(X,E=>{F()&&E(D)})}r(q,_),dt()}Oe(["click"]);var Kt=c(`<div><pre><code class="text-gray-300 whitespace-pre-wrap break-words"> </code></pre> <button type="button" class="
			absolute top-2 right-2
			p-2 rounded-lg
			bg-dark-700/80 border border-white/10
			text-gray-400 hover:text-white
			opacity-0 group-hover:opacity-100
			transition-all
		"><!></button></div>`);function Re(q,o){let F=ge(o,"error",3,!1),u=ge(o,"maxHeight",3,"360px"),j=ge(o,"class",3,""),N=$e(!1);async function A(){try{await navigator.clipboard.writeText(o.code),S(N,!0),setTimeout(()=>S(N,!1),2e3)}catch{const f=document.createElement("textarea");f.value=o.code,f.style.position="fixed",f.style.left="-9999px",document.body.appendChild(f),f.select(),document.execCommand("copy"),document.body.removeChild(f),S(N,!0),setTimeout(()=>S(N,!1),2e3)}}var _=Kt(),X=a(_),D=a(X),E=a(D,!0);t(D),t(X);var b=s(X,2);b.__click=A;var Q=a(b);{var ae=f=>{Rt(f,{size:16,class:"text-emerald-400"})},ie=f=>{It(f,{size:16})};O(Q,f=>{e(N)?f(ae):f(ie,!1)})}t(b),t(_),k(()=>{je(_,1,`relative group ${j()??""}`),je(X,1,`
			p-4 rounded-xl overflow-auto font-mono text-sm
			bg-black/40 border
			${F()?"border-red-500/50 shadow-lg shadow-red-500/20":"border-white/10"}
		`),Pt(X,`max-height: ${u()??""}`),g(E,o.code)}),r(q,_)}Oe(["click"]);var Dt=c("<!> Alle loeschen",1),Wt=c("<!> Aktualisieren",1),Ut=c("<!> <!>",1),Gt=c('<option class="bg-gray-900"> </option>'),Vt=c('<option class="bg-gray-900"> </option>'),Xt=c('<div class="flex justify-center py-12"><!></div>'),Qt=c('<div class="text-center py-12 text-gray-400"><!> <p>Keine Jobs vorhanden</p></div>'),Yt=c('<button type="button"><div class="flex items-center justify-between gap-2 mb-2"><span class="font-medium truncate"> </span> <!></div> <div class="flex items-center gap-4 text-xs text-gray-400"><span> </span> <span> </span></div></button>'),Zt=c('<div class="space-y-2 max-h-[500px] overflow-y-auto"></div> <div class="flex items-center justify-between mt-4 pt-4 border-t border-white/10"><span class="text-sm text-gray-400"> </span> <div class="flex gap-2"><!> <!></div></div>',1),ea=c(`<div class="mb-4 space-y-3"><div class="relative"><!> <!></div> <div class="flex flex-wrap gap-2"><select class="px-3 py-2 rounded-xl bg-white/5 border border-white/10 text-sm text-white
						focus:outline-none focus:border-royal-400/60 focus:ring-4 focus:ring-royal-400/10
						cursor-pointer"></select> <select class="px-3 py-2 rounded-xl bg-white/5 border border-white/10 text-sm text-white
						focus:outline-none focus:border-royal-400/60 focus:ring-4 focus:ring-royal-400/10
						cursor-pointer"></select></div></div> <!>`,1),ta=c("<!> Replay",1),aa=c("<!> <!>",1),ra=c('<div class="p-3 rounded-xl bg-black/20 border border-white/5"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium"> </span> <!></div> <div class="grid md:grid-cols-2 gap-2"><!> <!></div></div>'),sa=c('<div><h4 class="text-sm font-medium text-gray-400 mb-2"> </h4> <div class="space-y-3 max-h-[300px] overflow-y-auto"></div></div>'),oa=c('<div class="flex items-center justify-between mb-4"><div><h3 class="text-lg font-semibold"> </h3> <p class="text-sm text-gray-400"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div> <div class="space-y-4"><div><h4 class="text-sm font-medium text-gray-400 mb-2">Request</h4> <!></div> <div><h4 class="text-sm font-medium text-gray-400 mb-2">Response</h4> <!></div> <!></div>',1),la=c('<div class="text-center py-12 text-gray-400"><!> <p>Waehle einen Job aus der Liste</p></div>'),ia=c("<!> <!>",1),na=c(`<div class="space-y-4"><p class="text-sm text-gray-400">Bearbeite das Request-Payload und sende den Job erneut.</p> <!> <textarea class="
				w-full h-64 p-4 rounded-xl
				bg-black/30 border border-white/10
				font-mono text-sm text-white
				resize-none outline-none
				focus:border-royal-400/60 focus:ring-4 focus:ring-royal-400/10
			"></textarea></div>`),da=c('<!> <!> <div class="grid lg:grid-cols-2 gap-6"><!> <!></div> <!>',1);function Ca(q,o){nt(o,!0);const F=()=>Ye(At,"$permissions",j),u=()=>Ye(M,"$jobsStore",j),[j,N]=kt();let A=l(F),_=l(()=>u().jobs),X=l(()=>u().total),D=l(()=>u().page),E=l(()=>u().pageSize),b=l(()=>u().selectedJobId),Q=l(()=>u().statusFilter),ae=l(()=>u().typeFilter),ie=l(()=>u().loading),f=l(()=>u().error),n=l(()=>e(_).find(i=>i.id===e(b))??null),we=l(()=>Math.max(1,Math.ceil(e(X)/e(E)))),Ne="",W;const Y=[{value:"all",label:"Alle"},{value:"success",label:"Erfolgreich"},{value:"failed",label:"Fehlgeschlagen"}],ne=[{value:"all",label:"Alle Typen"},{value:"product",label:"Produkte"},{value:"customer",label:"Kunden"},{value:"transaction",label:"Transaktionen"},{value:"media",label:"Medien"}];let de=$e(!1),Z=$e(""),pe=$e(!1),ee=$e("");bt(()=>{M.load();const i=setInterval(()=>M.load(),15e3);return()=>clearInterval(i)});function ct(i){const P=i.target;clearTimeout(W),W=setTimeout(()=>{M.setSearch(P.value)},300)}async function vt(i){if(confirm("Diesen Job wirklich loeschen?"))try{await M.deleteJob(i)}catch(P){alert(P instanceof Error?P.message:"Fehler beim Loeschen")}}async function ut(){if(confirm("Gesamte Job-Historie wirklich loeschen?"))try{await M.deleteAllJobs()}catch(i){alert(i instanceof Error?i.message:"Fehler beim Loeschen")}}function ft(){e(n)&&(S(Z,e(n).requestPayload||"{}",!0),S(ee,""),S(de,!0))}async function _t(){if(e(n)){try{JSON.parse(e(Z))}catch{S(ee,"Ungueltiges JSON");return}S(pe,!0),S(ee,"");try{await M.replayJob(e(n).id,e(Z)),S(de,!1),M.load()}catch(i){S(ee,i instanceof Error?i.message:"Replay fehlgeschlagen",!0)}finally{S(pe,!1)}}}var Ue=da();zt("4b134t",i=>{yt(()=>{$t.title="Jobs | Actindo Middleware"})});var Ge=J(Ue);Ct(Ge,{title:"Job Monitor",subtitle:"Uebersicht aller API-Jobs und Fehler",actions:P=>{var R=Ut(),h=J(R);{var I=p=>{{let d=l(()=>e(_).length===0);le(p,{variant:"danger",onclick:ut,get disabled(){return e(d)},children:(v,U)=>{var m=Dt(),me=J(m);it(me,{size:16}),B(),r(v,m)},$$slots:{default:!0}})}};O(h,p=>{e(A).canWrite&&p(I)})}var H=s(h,2);le(H,{variant:"ghost",onclick:()=>M.load(),get disabled(){return e(ie)},children:(p,d)=>{var v=Wt(),U=J(v);{let m=l(()=>e(ie)?"animate-spin":"");Tt(U,{size:16,get class(){return e(m)}})}B(),r(p,v)},$$slots:{default:!0}}),r(P,R)}});var Ve=s(Ge,2);{var pt=i=>{ot(i,{variant:"error",class:"mb-6",children:(P,R)=>{B();var h=_e();k(()=>g(h,e(f))),r(P,h)},$$slots:{default:!0}})};O(Ve,i=>{e(f)&&i(pt)})}var Ee=s(Ve,2),Xe=a(Ee);st(Xe,{children:(i,P)=>{var R=ea(),h=J(R),I=a(h),H=a(I);jt(H,{size:18,class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"});var p=s(H,2);Jt(p,{type:"search",placeholder:"Suche nach Endpoint...",value:Ne,oninput:ct,class:"pl-11"}),t(I);var d=s(I,2),v=a(d);v.__change=x=>M.setStatusFilter(x.currentTarget.value),Te(v,21,()=>Y,Fe,(x,z)=>{var y=Gt(),re=a(y,!0);t(y);var K={};k(()=>{g(re,e(z).label),K!==(K=e(z).value)&&(y.value=(y.__value=e(z).value)??"")}),r(x,y)}),t(v);var U;et(v);var m=s(v,2);m.__change=x=>M.setTypeFilter(x.currentTarget.value),Te(m,21,()=>ne,Fe,(x,z)=>{var y=Vt(),re=a(y,!0);t(y);var K={};k(()=>{g(re,e(z).label),K!==(K=e(z).value)&&(y.value=(y.__value=e(z).value)??"")}),r(x,y)}),t(m);var me;et(m),t(d),t(h);var ke=s(h,2);{var Ie=x=>{var z=Xt(),y=a(z);Mt(y,{}),t(z),r(x,z)},Pe=x=>{var z=be(),y=J(z);{var re=se=>{var G=Qt(),ce=a(G);lt(ce,{size:48,class:"mx-auto mb-4 opacity-50"}),B(2),t(G),r(se,G)},K=se=>{var G=Zt(),ce=J(G);Te(ce,21,()=>e(_),Fe,(L,T)=>{var w=Yt();w.__click=()=>M.selectJob(e(T).id);var te=a(w),ve=a(te),ye=a(ve,!0);t(ve);var He=s(ve,2);{let fe=l(()=>e(T).success?"success":"error");Be(He,{get variant(){return e(fe)},children:(Ce,Le)=>{B();var Qe=_e();k(()=>g(Qe,e(T).success?"OK":"Fehler")),r(Ce,Qe)},$$slots:{default:!0}})}t(te);var Je=s(te,2),he=a(Je),Se=a(he,!0);t(he);var Ae=s(he,2),ue=a(Ae,!0);t(Ae),t(Je),t(w),k((fe,Ce)=>{je(w,1,`
							w-full text-left p-4 rounded-xl border transition-all
							${e(T).id===e(b)?"bg-royal-600/20 border-royal-600/50":"bg-white/5 border-white/10 hover:bg-white/10"}
						`),g(ye,e(T).endpoint),g(Se,fe),g(ue,Ce)},[()=>rt(e(T).durationMilliseconds),()=>at(e(T).startedAt)]),r(L,w)}),t(ce);var ze=s(ce,2),xe=a(ze),$=a(xe);t(xe);var C=s(xe,2),V=a(C);{let L=l(()=>e(D)<=1);le(V,{variant:"ghost",size:"small",get disabled(){return e(L)},onclick:()=>M.setPage(e(D)-1),children:(T,w)=>{Et(T,{size:16})},$$slots:{default:!0}})}var oe=s(V,2);{let L=l(()=>e(D)>=e(we));le(oe,{variant:"ghost",size:"small",get disabled(){return e(L)},onclick:()=>M.setPage(e(D)+1),children:(T,w)=>{Nt(T,{size:16})},$$slots:{default:!0}})}t(C),t(ze),k(()=>g($,`Seite ${e(D)??""} / ${e(we)??""}`)),r(se,G)};O(y,se=>{e(_).length===0?se(re):se(K,!1)},!0)}r(x,z)};O(ke,x=>{e(ie)&&e(_).length===0?x(Ie):x(Pe,!1)})}k(()=>{U!==(U=e(Q))&&(v.value=(v.__value=e(Q))??"",tt(v,e(Q))),me!==(me=e(ae))&&(m.value=(m.__value=e(ae))??"",tt(m,e(ae)))}),r(i,R)},$$slots:{default:!0}});var mt=s(Xe,2);st(mt,{children:(i,P)=>{var R=be(),h=J(R);{var I=p=>{var d=oa(),v=J(d),U=a(v),m=a(U),me=a(m,!0);t(m);var ke=s(m,2),Ie=a(ke);t(ke),t(U);var Pe=s(U,2),x=a(Pe);{let $=l(()=>e(n).success?"success":"error");Be(x,{get variant(){return e($)},children:(C,V)=>{B();var oe=_e();k(()=>g(oe,e(n).success?"Erfolgreich":"Fehler")),r(C,oe)},$$slots:{default:!0}})}var z=s(x,2);{var y=$=>{var C=aa(),V=J(C);le(V,{variant:"ghost",size:"small",onclick:ft,children:(L,T)=>{var w=ta(),te=J(w);Ht(te,{size:14}),B(),r(L,w)},$$slots:{default:!0}});var oe=s(V,2);le(oe,{variant:"danger",size:"small",onclick:()=>vt(e(n).id),children:(L,T)=>{it(L,{size:14})},$$slots:{default:!0}}),r($,C)};O(z,$=>{e(A).canWrite&&$(y)})}t(Pe),t(v);var re=s(v,2),K=a(re),se=s(a(K),2);{let $=l(()=>Me(e(n).requestPayload));Re(se,{get code(){return e($)},maxHeight:"200px"})}t(K);var G=s(K,2),ce=s(a(G),2);{let $=l(()=>Me(e(n).success?e(n).responsePayload:e(n).errorPayload??e(n).responsePayload)),C=l(()=>!e(n).success);Re(ce,{get code(){return e($)},get error(){return e(C)},maxHeight:"200px"})}t(G);var ze=s(G,2);{var xe=$=>{var C=sa(),V=a(C),oe=a(V);t(V);var L=s(V,2);Te(L,21,()=>e(n).actindoLogs,Fe,(T,w)=>{var te=ra(),ve=a(te),ye=a(ve),He=a(ye,!0);t(ye);var Je=s(ye,2);{let ue=l(()=>e(w).success?"success":"error");Be(Je,{get variant(){return e(ue)},children:(fe,Ce)=>{B();var Le=_e();k(()=>g(Le,e(w).success?"OK":"Fehler")),r(fe,Le)},$$slots:{default:!0}})}t(ve);var he=s(ve,2),Se=a(he);{let ue=l(()=>Me(e(w).requestPayload));Re(Se,{get code(){return e(ue)},maxHeight:"120px"})}var Ae=s(Se,2);{let ue=l(()=>Me(e(w).responsePayload)),fe=l(()=>!e(w).success);Re(Ae,{get code(){return e(ue)},get error(){return e(fe)},maxHeight:"120px"})}t(he),t(te),k(()=>g(He,e(w).endpoint)),r(T,te)}),t(L),t(C),k(()=>g(oe,`Actindo Calls (${e(n).actindoLogs.length??""})`)),r($,C)};O(ze,$=>{e(n).actindoLogs&&e(n).actindoLogs.length>0&&$(xe)})}t(re),k(($,C)=>{g(me,e(n).endpoint),g(Ie,`${$??""} - ${C??""}`)},[()=>at(e(n).startedAt),()=>rt(e(n).durationMilliseconds)]),r(p,d)},H=p=>{var d=la(),v=a(d);lt(v,{size:48,class:"mx-auto mb-4 opacity-50"}),B(2),t(d),r(p,d)};O(h,p=>{e(n)?p(I):p(H,!1)})}r(i,R)},$$slots:{default:!0}}),t(Ee);var ht=s(Ee,2);qt(ht,{title:"Job Replay",get open(){return e(de)},set open(P){S(de,P,!0)},footer:P=>{var R=ia(),h=J(R);le(h,{variant:"ghost",onclick:()=>S(de,!1),children:(H,p)=>{B();var d=_e("Abbrechen");r(H,d)},$$slots:{default:!0}});var I=s(h,2);le(I,{onclick:_t,get disabled(){return e(pe)},children:(H,p)=>{B();var d=_e();k(()=>g(d,e(pe)?"Sende...":"Replay senden")),r(H,d)},$$slots:{default:!0}}),r(P,R)},children:(P,R)=>{var h=na(),I=s(a(h),2);{var H=d=>{ot(d,{variant:"error",children:(v,U)=>{B();var m=_e();k(()=>g(m,e(ee))),r(v,m)},$$slots:{default:!0}})};O(I,d=>{e(ee)&&d(H)})}var p=s(I,2);wt(p),t(h),St(p,()=>e(Z),d=>S(Z,d)),r(P,h)},$$slots:{footer:!0,default:!0}}),r(q,Ue),dt(),N()}Oe(["change","click"]);export{Ca as component};
